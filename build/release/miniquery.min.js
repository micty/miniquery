/*
 * MiniQuery JavaScript Library
 */
(function(a,f,e,k,h,c,b,j,i,o,l,d){function n(){}var g=n;n.expando="MiniQuery"+l(b.random()).replace(/\D/g,"");n.extend=function(v,r,q){if(r&&typeof r=="object"){for(var x in r){v[x]=r[x]}}if(q&&typeof q=="object"){for(var x in q){v[x]=q[x]}}var w=3;var u=arguments.length;if(w>=u){return v}for(var t=w;t<u;t++){var s=arguments[t];for(var p in s){v[p]=s[p]}}return v};n.Object=function(p){return new n.Object.prototype.init(p)};(function(p,q){p.extend(q,{extend:p.extend,extendSafely:function(){var r=arguments.length;if(r==0){return null}var v=arguments[0];if(r==1){return v}for(var t=1;t<r;t++){var u=arguments[t];for(var s in u){if(s in v){continue}v[s]=u[s]}}return v},extendDeeply:function(w,y,v){function t(z,E){z=z||{};for(var C in E){var D=E[C];if(q.isPlain(D)){D=t(z[C],D)}z[C]=D}return z}if(y&&typeof y=="object"){w=t(w,y)}if(v&&typeof v=="object"){w=t(w,v)}var x=3;var r=arguments.length;if(x>=r){return w}for(var s=x;s<r;s++){var u=arguments[s];w=t(w,u)}return w},clone:function(v){var w=arguments.callee;var t=n;if(q.isArray(v)){return t.Array.keep(v,function(y,x){if(!y||q.isValueType(y)||!q.isPlain(y)){return y}return w(y)})}if(!v||q.isValueType(v)||!q.isPlain(v)){return v}var u={};for(var r in v){var s=v[r];switch(typeof s){case"string":case"number":case"boolean":case"function":case"undefined":u[r]=s;break;case"object":u[r]=w(s);break}}return u},each:function(w,t,r){var v=arguments.callee;for(var s in w){var u=w[s];if(r===true&&u&&typeof u=="object"){v(u,t,true)}else{if(t(s,u)===false){break}}}},getType:function(r){return r===null?"null":r===d?"undefined":typeof r=="string"?"string":typeof r=="number"?"number":typeof r=="boolean"?"boolean":i.prototype.toString.call(r).slice(8,-1)},isArray:function(s,r){if(r===true){return s instanceof f}if(typeof f.isArray=="function"){return f.isArray(s)}return(s instanceof f)||(q.getType(s)=="Array")},isString:function(r){return typeof r=="string"},isNumber:function(r){return typeof r=="number"},isFunction:function(r){return typeof r=="function"},isBuiltinType:function(u){var t=[l,j,e,f,k,o,c];for(var s=0,r=t.length;s<r;s++){if(u instanceof t[s]){return true}}return false},isEmpty:function(s){for(var r in s){return false}return true},isPlain:function(v){if(!v||typeof v!="object"){return false}var t=i.prototype.hasOwnProperty;var s=v.constructor;try{if(s&&!t.call(v,"constructor")&&!t.call(s.prototype,"isPrototypeOf")){return false}}catch(u){return false}var r;for(r in v){}return r===d||t.call(v,r)},isValueType:function(s){var r=typeof s;return r=="string"||r=="number"||r=="boolean"},isWrappedType:function(u){var t=[l,j,e];for(var s=0,r=t.length;s<r;s++){if(u instanceof t[s]){return true}}return false},isNonNull:function(s){if(!s){return false}var r=typeof s;return r=="object"||r=="function"},isWindow:function(r){return r&&typeof r=="object"&&"setInterval" in r},isDocument:function(r){return r&&typeof r=="object"&&"getElementById" in r},map:function(x,t,r){var w=arguments.callee;var v={};for(var s in x){var u=x[s];if(r&&u&&typeof u=="object"){v[s]=w(u,t,r)}else{v[s]=t(s,u)}}return v},namespace:function(v,u,t){function x(B,K,I){var H=K.split(".");var E=B;var G=H.length;var F=G-1;var C=I===d;for(var D=0;D<G;D++){var J=H[D];if(C&&!(J in E)){return}if(D<F){E[J]=E[J]||{};E=E[J]}else{if(I===d){return E[J]}E[J]=I}}return I}if(typeof u=="string"){var s=v;var A=u;var y=t;return x(s,A,y)}if(typeof v=="string"){var s=a;var A=v;var y=u;return x(s,A,y)}if(q.isPlain(u)&&t===d){var r=v;var w=u;var s=a;q.each(w,function(B,D){if(typeof D!="string"){throw new h("当指定第二个参数为键值对映射表时，值必须为 string 类型")}var C=r[B];x(s,D,C)});return s}if(q.isArray(t)){var s=v;var r=u;var z=t;p.Array.each(z,function(B){s[B]=r[B]});return s}},parseJson:function(t){if(typeof t!=="string"||!t){return null}t=p.String.trim(t);if(a.JSON&&a.JSON.parse){return a.JSON.parse(t)}var r=/^[\],:{}\s]*$/,s=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,v=/(?:^|:|,)(?:\s*\[)+/g;t=t.replace(s,"@").replace(u,"]").replace(v,"");if(!r.test(t)){throw new h("非法的 JSON 数据: "+t)}return(new c("return "+t))()},parseQueryString:function(t,D,v){if(!t||typeof t!="string"){return{}}var C=arguments.callee;var r=v?unescape:decodeURIComponent;var z=!D;var B=p.String.toValue;var y={};var u=t.split("&");for(var x=0,A=u.length;x<A;x++){var w=u[x].split("=");var s=r(w[0]);var F=w.length>1?r(w[1]):"";if(z&&F.indexOf("=")>0){F=C(F)}else{F=B(F)}if(s in y){var E=y[s];if(E instanceof f){E.push(F)}else{y[s]=[E,F]}}else{y[s]=F}}return y},remove:function(w,u){var v=q.extend({},w);if(typeof u=="string"){delete v[u]}else{if(q.isArray(u)){for(var t=0,r=u.length;t<r;t++){delete v[u[t]]}}else{for(var s in u){delete v[s]}}}return v},replaceValues:function(v,u,r){for(var t in v){var w=v[t];switch(typeof w){case"string":case"number":case"boolean":for(var s in u){if(t==s){v[t]=u[s];break}}break;case"object":!r&&arguments.callee(w,u);break}}return v},toArray:function(s,x,u){var r=arguments.callee;if(!x){return q.getValues(s,u)}if(x instanceof f){var B=x;var y=[];for(var t=0,v=B.length;t<v;t++){var z=s[B[t]];y.push(z)}return y}if(x===true){var y=[];for(var A in s){var z=s[A];if(u===true&&z&&typeof z=="object"){z=r(z,x,u)}y.push([A,z])}return y}if(typeof x=="function"){var w=x;var y=[];for(var A in s){var z=s[A];if(u===true&&z&&typeof z=="object"){z=r(z,x,u)}else{z=w(A,z)}if(z===null){continue}if(z===d){break}y.push(z)}return y}},toJson:function(w){if(w==null){return l(w)}switch(typeof w){case"string":return'"'+w+'"';case"number":case"boolean":return w;case"function":return w.toString()}if(w instanceof l||w instanceof j||w instanceof e||w instanceof k){return arguments.callee(w.valueOf())}if(w instanceof o){return arguments.callee(w.toString())}if(q.isArray(w)){var v=[];for(var t=0,r=w.length;t<r;t++){v.push(arguments.callee(w[t]))}return"["+v.join(", ")+"]"}var u=[];for(var s in w){u.push('"'+s+'": '+arguments.callee(w[s]))}return"{ "+u.join(", ")+" }"},toQueryString:function(v,w){if(v==null){return l(v)}switch(typeof v){case"string":case"number":case"boolean":return v}if(v instanceof l||v instanceof j||v instanceof e||v instanceof k){return v.valueOf()}if(q.isArray(v)){return"["+v.join(", ")+"]"}var s=arguments.callee;var t=w?escape:encodeURIComponent;var u=[];for(var r in v){u.push(t(r)+"="+t(s(v[r])))}return u.join("&")},trim:function(t,z,u){if(!z&&!u){var v={};for(var y in t){var x=t[y];if(x==null){continue}v[y]=x}return v}var r=arguments.callee;var s=p.Array.contains;var w=q.extend;if(typeof z=="boolean"){u=z;z=d}if(!z){z=[null,d]}var v=w({},t);for(var y in v){var x=v[y];if(s(z,x)){delete v[y];continue}if(u===true&&typeof x=="object"&&x){x=w({},x);v[y]=r(x,z,true)}}return v},create:function(s){var r=typeof i.create==="function"?i.create:function(u){function t(){}t.prototype=u;t.prototype.constructor=t;return new t()};q.create=r;return r(s)},filter:function(u,r){var t={};if(q.isArray(r)){p.Array.each(r,function(w,v){if(w in u){t[w]=u[w]}})}else{if(q.isPlain(r)){q.each(r,function(v,w){if(v in u){t[v]=u[v]}})}else{if(typeof r=="string"){var s=r;if(s in u){t[s]=u[s]}}else{throw new h("无法识别参数 samples 的类型")}}}return t},filterTo:function(t,u,r){var s=q.filter(u,r);return q.extend(t,s)},grep:function(v,s){var u={};for(var r in v){var t=v[r];if(s(r,t)===true){u[r]=t}}return u},find:function(u,s,r){var t=false;q.each(u,function(v,w){if(s(v,w)===true){t=true;return false}},r);return t},findItem:function(u,s,r){var t=[];q.each(u,function(v,w){if(s(v,w)===true){t=[v,w];return false}},r);return t},findKey:function(u,s,r){var t=q.findItem(u,s,r);return t[0]},findValue:function(u,s,r){var t=q.findItem(u,s,r);return t[1]},get:function(t,s,r){if(!t){return r}if(s in t){return t[s]}return r},set:function(t,r,s){t[r]=s;return t},make:function(r,t){var s=n;var u={};if(q.isArray(r)){s.Array(arguments).each(function(w,v){u[w[0]]=w[1]})}else{u[r]=t}return u},getKeys:function(w,s){var u=arguments.callee;var r=[];for(var t in w){var v=w[t];if(s===true&&typeof v=="object"&&v!==null){t=u(v,s)}r.push(t)}return r},getValues:function(w,s){var u=arguments.callee;var r=[];for(var t in w){var v=w[t];if(s===true&&typeof v=="object"&&v!==null){v=u(v,s)}r.push(v)}return r},getItems:function(s,r){return q.toArray(s,true,r)},join:function(s,t,v){t=t||"=";v=v||"&";var u=[];for(var r in s){u.push(r+t+s[r])}return u.join(v)}})})(n,n.Object);(function(q){var p=f.prototype.slice;q.prototype={constructor:q,value:{},init:function(r){this.value=i(r)},valueOf:function(){return this.value},clone:function(){return q.clone(this.value)},each:function(t,r){var s=p.call(arguments,0);s=[this.value].concat(s);q.each.apply(null,s);return this},extend:function(){var r=p.call(arguments,0);r=[this.value].concat(r);this.value=q.extend.apply(null,r);return this},extendSafely:function(){var r=[this.value].concat(p.call(arguments,0));this.value=q.extendSafely.apply(null,r);return this},getType:function(){return q.getType(this.value)},isArray:function(r){return q.isArray(this.value,r)},isBuiltinType:function(){return q.isBuiltinType(this.value)},isEmpty:function(){return q.isEmpty(this.value)},isPlain:function(){return q.isPlain(this.value)},isValueType:function(){return q.isValueType(this.value)},isWindow:function(){return q.isWindow(this.value)},isWrappedType:function(){return q.isWrappedType(this.value)},map:function(t,r){var s=p.call(arguments,0);s=[this.value].concat(s);this.value=q.map.apply(null,s);return this},namespace:function(t,s){var r=p.call(arguments,0);r=[this.value].concat(r);this.value=q.namespace.apply(null,r);return this},parseJson:function(r){this.value=q.parseJson(r);return this},parseQueryString:function(t,r,u){var s=p.call(arguments,0);this.value=q.parseQueryString.apply(null,s);return this},remove:function(r){this.value=q.remove(this.value,r);return this},replaceValues:function(t,r){var s=p.call(arguments,0);s=[this.value].concat(s);this.value=q.replaceValues.apply(null,s);return this},toArray:function(t,r){var s=p.call(arguments,0);s=[this.value].concat(s);return q.toArray.apply(null,s)},toJson:function(){return q.toJson(this.value)},toQueryString:function(s){var r=p.call(arguments,0);r=[this.value].concat(r);return q.toQueryString.apply(null,r)},join:function(t,s){var r=p.call(arguments,0);r=[this.value].concat(r);return q.join.apply(null,r)},trim:function(s,r){var t=p.call(arguments,0);t=[this.value].concat(t);this.value=q.trim.apply(null,t);return this},filter:function(r){this.value=q.filter(this.value,r);return this},filterTo:function(s,r){this.value=q.filterTo(this.value,s,r);return this},grep:function(r){this.value=q.grep(this.value,r);return this},find:function(s,r){return q.find(this.value,s,r)},findItem:function(s,r){return q.findItem(this.value,s,r)},findKey:function(s,r){return q.findKey(this.value,s,r)},findValue:function(s,r){return q.findValue(this.value,s,r)},get:function(s,r){return q.get(this.value,s,r)},set:function(r,s){q.set(this.value,r,s);return this},make:function(r,s){this.value=q.make(r,s);return this},getKeys:function(r){return q.getKeys(this.value,r)},getValues:function(r){return q.getValues(this.value,r)},getItems:function(r){return q.getItems(this.value,r)}};q.prototype.init.prototype=q.prototype})(n.Object);n.Array=function(p){return new n.Array.prototype.init(p)};(function(p,q){p.extend(q,{each:function(v,t,u){var r=v.length;if(u===true){for(var s=r;s--;){if(t(v[s],s)===false){break}}}else{for(var s=0;s<r;s++){if(t(v[s],s)===false){break}}}return v},parse:function(x,t){if(x instanceof f){return x}var s=[];if(t===true){for(var u in x){if(u==="length"){continue}s.push(x[u])}return s}if(!x||!x.length){return[]}try{s=f.prototype.slice.call(x,0)}catch(w){for(var v=0,r=x.length;v<r;v++){s.push(x[v])}}return s},toObject:function(w,x){if(!w||!p.Object.isArray(w)){return null}var r={};if(x===d){var u=w.length;r.length=u;for(var s=0;s<u;s++){r[s]=w[s]}return r}if(p.Object.isArray(x)){var t=0;var u=x.length;for(var s=0;s<u;s++){var z=x[s];if(z in r){continue}r[z]=w[s];t++}r.length=t;return r}if(p.Object.isPlain(x)){var u=0;for(var z in x){r[z]=w[x[z]];u++}r.length=u;return r}if(typeof x=="function"){var u=w.length;for(var s=0;s<u;s++){var A=x(w[s],s);if(A instanceof f){var z=A[0];var y=A[1];r[z]=y}else{if(p.Object.isPlain(A)){for(var z in A){r[z]=A[z];break}}else{throw new h("处理函数 maps 返回结果的格式不可识别")}}}r.length=u;return r}return r},map:function(w,u){var s=[];for(var t=0,r=w.length;t<r;t++){var v=u(w[t],t);if(v===null){continue}if(v===d){break}s.push(v)}return s},keep:function(w,u){var s=[];for(var t=0,r=w.length;t<r;t++){var v=u(w[t],t);s.push(v)}return s},grep:function(w,u){var s=[];for(var t=0,r=w.length;t<r;t++){var v=w[t];if(u(v,t)===true){s.push(v)}}return s},indexOf:function(u,t){if(typeof u.indexOf=="function"){return u.indexOf(t)}for(var s=0,r=u.length;s<r;s++){if(u[s]===t){return s}}return -1},contains:function(s,r){return q.indexOf(s,r)>-1},remove:function(w,v){var s=[];for(var t=0,r=w.length;t<r;t++){var u=w[t];if(u===v){continue}s.push(u)}return s},removeAt:function(t,s){var r=t.slice(0);r.splice(s,1);return r},reverse:function(t){var r=[];for(var s=t.length-1;s>=0;s--){r.push(t[s])}return r},merge:function(){var t=[];for(var u=0,s=arguments.length;u<s;u++){var r=arguments[u];if(r===d){continue}t=t.concat(r)}return t},mergeUnique:function(){var x=[];var t=arguments.length;var w=q.contains;for(var u=0;u<t;u++){var s=arguments[u];var r=s.length;for(var v=0;v<r;v++){if(!w(x,s[v])){x.push(s[v])}}}return x},unique:function(r){return q.mergeUnique(r)},toggle:function(t,r){if(q.contains(t,r)){return q.remove(t,r)}else{var s=t.slice(0);s.push(r);return s}},find:function(t,r,s){return q.findIndex(t,r,s)>-1},findIndex:function(v,t,u){u=u||0;for(var s=u,r=v.length;s<r;s++){if(t(v[s],s)===true){return s}}return -1},findItem:function(w,t,v){v=v||0;for(var s=v,r=w.length;s<r;s++){var u=w[s];if(t(u,s)===true){return u}}return null},random:function(v){var w=v.slice(0);for(var u=0,r=w.length;u<r;u++){var s=parseInt(b.random()*u);var t=w[u];w[u]=w[s];w[s]=t}return w},randomItem:function(t){var r=t.length;if(r<1){return d}var s=p.Math.randomInt(0,r-1);return t[s]},get:function(u,s){var r=u.length;if(s>=0&&s<r){return u[s]}var t=s+r;if(s<0&&t>=0){return u[t]}if(s==null){return u.slice(0)}},trim:function(r){return q.map(r,function(t,s){return t==null?null:t})},group:function(u,s,t){var r=q.slide(u,s,s);if(t===true){r[r.length-1]=u.slice(-s)}return r},slide:function(x,v,t){if(v>=x.length){return[x]}t=t||1;var s=[];for(var w=0,r=x.length;w<r;w=w+t){var u=w+v;s.push(x.slice(w,u));if(u>=r){break}}return s},circleSlice:function(w,v,t){var s=w.slice(v,v+t);var r=[];var u=t-s.length;if(u>0){r=w.slice(0,u)}return s.concat(r)},circleSlide:function(x,v,t){if(x.length<v){return[x]}t=t||1;var s=[];var u=q.circleSlice;for(var w=0,r=x.length;w<r;w=w+t){s.push(u(x,w,v))}return s},sum:function(y,s,v){var w=0;var t=!(v===d);for(var u=0,r=y.length;u<r;u++){var x=t?y[u][v]:y[u];if(isNaN(x)){if(s===true){continue}else{throw new h("第 "+u+" 个元素的值为 NaN")}}else{w+=j(x)}}return w},max:function(y,t,w){var s=0;var u=!(w===d);for(var v=0,r=y.length;v<r;v++){var x=u?y[v][w]:y[v];if(isNaN(x)){if(t===true){continue}else{throw new h("第 "+v+" 个元素的值为 NaN")}}else{x=j(x);if(x>s){s=x}}}return s},hasItem:function(r){return p.Object.isArray(r)&&r.length>0},reduceDimension:function(v,t){t=t||1;var r=v;var u=f.prototype.concat;for(var s=0;s<t;s++){r=u.apply([],r)}return r},descartes:function(t,s){var w=v(t,s);for(var u=2,r=arguments.length;u<r;u++){w=v(w,arguments[u],true)}return w;function v(y,x,F){var E=[];for(var C=0,D=y.length;C<D;C++){for(var z=0,H=x.length;z<H;z++){var G=[];if(F){G=G.concat(y[C]);G.push(x[z])}else{G[0]=y[C];G[1]=x[z]}E.push(G)}}return E}},divideDescartes:function(v,A){var z=v.length;var w=[];for(var t=0,u=A.length;t<u;t++){var B=A[t];var r=z/B;var x=[];for(var y=0;y<B;y++){x.push(v[y*r][t])}z=r;w[t]=x}return w},transpose:function(z){var s=z;var w=[];var v=s.length;var x=1;for(var y=0;y<x;y++){var t=[];for(var u=0;u<v;u++){if(s[u].length>x){x=s[u].length}t.push(s[u][y])}w[y]=t}return w},intersection:function(t,s){var w=t;for(var u=1,r=arguments.length;u<r;u++){w=v(w,arguments[u])}return w;function v(y,G){var F=[];for(var D=0,x=y.length;D<x;D++){var E=y[D];for(var z=0,C=G.length;z<C;z++){if(E===G[z]){F.push(E);break}}}return q.unique(F)}},equals:function(s,v,u){if(!(s instanceof f)||!(v instanceof f)||s.length!=v.length){return false}u=u||function(w,z){return w===z};for(var t=0,r=s.length;t<r;t++){if(!u(s[t],v[t])){return false}}return true},isContained:function(r,s){return q.intersection(r,s).length==r.length},padLeft:function(w,v,s){var u=v-w.length;if(u<=0){return w.slice(-u)}var r=[];for(var t=0;t<u;t++){r.push(s)}r=r.concat(w);return r},padRight:function(w,v,s){var u=v-w.length;if(u<=0){return w.slice(0,v)}var r=w.slice(0);for(var t=0;t<u;t++){r.push(s)}return r},pad:function(v,s,u){if(v==s){return[]}u=b.abs(u||1);var r=[];if(v<s){for(var t=v;t<s;t+=u){r.push(t)}}else{for(var t=v;t>s;t-=u){r.push(t)}}return r},aggregate:function(x,v,r){var y=typeof v=="string";var s=typeof r=="function";var t={};for(var u=0,w=x.length;u<w;u++){var B=x[u];var A=y?B[v]:v(B,u);if(!t[A]){t[A]=[]}var z=B;if(s){z=r(B,u);if(z===null){continue}if(z===d){break}}t[A].push(z)}return t},add:function(t,s){var r=t.slice(0);r.push(s);return r},count:function(u,s){if(arguments.length<2){return u.length}if(typeof s!="function"){var t=s;s=function(w,v){return w===t}}var r=q.grep(u,s);return r.length}})})(n,n.Array);(function(p){p.prototype={constructor:p,value:[],init:function(q){this.value=p.parse(q)},toString:function(q){q=q===d?"":q;return this.value.join(q)},valueOf:function(){return this.value},each:function(r,s){var q=f.prototype.slice.call(arguments,0);q=[this.value].concat(q);p.each.apply(null,q);return this},toObject:function(r){var q=f.prototype.slice.call(arguments,0);q=[this.value].concat(q);return p.toObject.apply(null,q)},map:function(r){var q=f.prototype.slice.call(arguments,0);q=[this.value].concat(q);p.map.apply(null,q);return this},keep:function(r){var q=f.prototype.slice.call(arguments,0);q=[this.value].concat(q);this.value=p.keep.apply(null,q);return this},grep:function(q){this.value=p.grep(this.value,q);return this},indexOf:function(q){return p.indexOf(this.value,q)},contains:function(q){return p.contains(this.value,q)},remove:function(q){this.value=p.remove(this.value,q);return this},removeAt:function(q){this.value=p.removeAt(this.value,q);return this},reverse:function(){this.value=p.reverse(this.value);return this},merge:function(){var q=[this.value];q=q.concat(f.prototype.slice.call(arguments,0));this.value=p.merge.apply(null,q);return this},mergeUnique:function(){var q=[this.value];q=q.concat(f.prototype.slice.call(arguments,0));this.value=p.mergeUnique.apply(null,q);return this},unique:function(){this.value=p.unique(this.value);return this},toggle:function(q){this.value=p.toggle(this.value,q);return this},find:function(q,r){return p.find(this.value,q,r)},findIndex:function(q,r){return p.findIndex(this.value,q,r)},findItem:function(q,r){return p.findItem(this.value,q,r)},random:function(){this.value=p.random(this.value);return this},randomItem:function(){return p.randomItem(this.value)},get:function(q){return p.get(this.value,q)},trim:function(){this.value=p.trim(this.value);return this},group:function(q,r){this.value=p.group(this.value,q,r);return this},slide:function(r,q){this.value=p.slide(this.value,r,q);return this},circleSlice:function(r,q){this.value=p.circleSlice(this.value,r,q);return this},circleSlide:function(r,q){this.value=p.circleSlide(this.value,r,q);return this},sum:function(q,r){return p.sum(this.value,q,r)},max:function(q,r){return p.max(this.value,q,r)},hasItem:function(){return p.hasItem(this.value)},reduceDimension:function(q){this.value=p.reduceDimension(this.value,q);return this},descartes:function(){var q=p.parse(arguments);q=[this.value].concat(q);this.value=p.descartes.apply(null,q);return this},divideDescartes:function(q){this.value=p.divideDescartes(this.value,q);return this},transpose:function(){this.value=p.transpose(this.value);return this},intersection:function(){var q=p.parse(arguments);q=[this.value].concat(q);this.value=p.intersection.apply(null,q);return this},equals:function(r,q){return p.equals(this.value,r,q)},isContained:function(q){return p.isContained(this.value,q)},padLeft:function(r,q){this.value=p.padLeft(this.value,r,q);return this},padRight:function(r,q){this.value=p.padRight(this.value,r,q);return this},pad:function(s,q,r){this.value=p.pad(s,q,r);return this}};p.prototype.init.prototype=p.prototype})(n.Array);n.String=function(q){if(arguments.length>1){var p=f.prototype.slice.call(arguments,1);return n.String.format(q,p)}return new n.String.prototype.init(q)};(function(p,q){p.extend(q,{format:function(v,z,t){var y=v;if(typeof z=="object"){for(var x in z){y=q.replaceAll(y,"{"+x+"}",z[x])}}else{var u=f.prototype.slice.call(arguments,1);for(var w=0,r=u.length;w<r;w++){y=q.replaceAll(y,"{"+w+"}",u[w])}}return y},replaceAll:function(s,t,r){return s.split(t).join(r)},replaceBetween:function(r,u,t,s){var y=r.indexOf(u);if(y<0){return r}var w=r.indexOf(t);if(w<0){return r}var v=r.slice(0,y);var x=r.slice(w+t.length);return v+s+x},removeAll:function(s,t){var r=q.replaceAll;if(p.Object.isArray(t)){p.Array.each(t,function(v,u){s=r(s,v,"")});return s}return r(s,t,"")},trim:function(r){return r.replace(/(^\s*)|(\s*$)/g,"")},trimStart:function(r){return r.replace(/(^\s*)/g,"")},trimEnd:function(r){return r.replace(/(\s*$)/g,"")},padLeft:function(u,t,v){u=l(u);var s=u.length;if(t<=s){return u.substr(-t)}v=v||" ";var r=[];r.length=t-s+1;return r.join(v)+u},padRight:function(u,t,v){u=l(u);var s=u.length;if(s>=t){return u.substring(0,t)}v=v||" ";var r=[];r.length=t-s+1;return u+r.join(v)},between:function(s,t,r){var v=s.indexOf(t);if(v<0){return""}v+=t.length;var u=s.indexOf(r,v);if(u<0){return""}return s.substr(v,u-v)},random:function(s){if(s===d){s=12}if(typeof s=="number"){var r=s+1;if(r<0){r=0}s=[];s.length=r;s=s.join("x")}return s.replace(/x/g,function(u){var t=b.random()*16|0;return t.toString(16)}).toUpperCase()}});p.extend(q,{startsWith:function(u,s,r){if(r){var t=u.substring(0,s.length);return t.toUpperCase()===s.toString().toUpperCase()}return u.indexOf(s)==0},endsWith:function(w,t,r){var u=w.length;var s=t.length;var x=u-s;if(r){var v=w.substring(x,u);return v.toUpperCase()===t.toString().toUpperCase()}return w.lastIndexOf(t)==x},contains:function(u,t,s){u=l(u);if(p.Object.isArray(t)){var r;if(s===true){r=false;p.Array.each(t,function(w,v){r=u.indexOf(w)>-1;if(r){return false}})}else{r=true;p.Array.each(t,function(w,v){r=u.indexOf(w)>-1;if(!r){return false}})}return r}return u.indexOf(t)>-1}});p.extend(q,{toCamelCase:function(s){var r=/^-ms-/;var t=/-([a-z]|[0-9])/ig;return s.replace(r,"ms-").replace(t,function(u,v){return v.toString().toUpperCase()})},toHyphenate:function(r){return r.replace(/[A-Z]/g,function(s){return("-"+s.charAt(0).toLowerCase())})},toUtf8:function(r){var s=[];p.Array.each(r.split(""),function(u,t){var v=u.charCodeAt(0);if(v<128){s.push(v)}else{if(v<2048){s.push(((v&1984)>>6)|192);s.push((v&63)|128)}else{s.push(((v&61440)>>12)|224);s.push(((v&4032)>>6)|128);s.push(((v&63))|128)}}});return"%"+p.Array.map(s,function(u,t){return u.toString(16)}).join("%")},toValue:function(r){if(typeof r!="string"){return r}var s={"true":true,"false":false,"null":null,"undefined":d,"NaN":NaN};return r in s?s[r]:r}});p.extend(q,{split:function(s,u){var w=l(s).split(u[0]);for(var t=1,r=u.length;t<r;t++){w=v(w,u[t],t)}return w;function v(x,z,y){y--;return p.Array.map(x,function(B,A){return y==0?l(B).split(z):v(B,z,y)})}},slide:function(t,s,r){var u=l(t).split("");return p.Array(u).slide(s,r).map(function(w,v){return w.join("")}).valueOf()},segment:function(r,s){return q.slide(r,s,s)}});p.extend(q,{getTemplates:function(y,u){var t=u[0];if(t instanceof f){u=p.Array.keep(u,function(z,s){var A={name:z[0],begin:z[1],end:z[2]};if(z.length>3){A.outer=z[3]}return A});t=u[0]}var x=q.between;var w=q.replaceBetween;var r={};var v=x(y,t.begin,t.end);p.Array.each(u.slice(1),function(C,A){var z=C.name||A;var B=C.begin;var s=C.end;r[z]=x(v,B,s);if("outer" in C){v=w(v,B,s,C.outer)}},true);r[t.name]=v;return r},getByteLength:function(r){if(!r){return 0}return r.toString().replace(/[\u0100-\uffff]/g,"  ").length}});p.extend(q,{escapeHtml:function(r){r=l(r);var s=/[&'"<>\/\\\-\x00-\x09\x0b-\x0c\x1f\x80-\xff]/g;r=r.replace(s,function(t){return"&#"+t.charCodeAt(0)+";"});r=r.replace(/ /g,"&nbsp;");r=r.replace(/\r\n/g,"<br />");r=r.replace(/\n/g,"<br />");r=r.replace(/\r/g,"<br />");return r},escapeElementAttribute:function(r){r=l(r);var s=/[&'"<>\/\\\-\x00-\x1f\x80-\xff]/g;return r.replace(s,function(t){return"&#"+t.charCodeAt(0)+";"})},escapeScript:function(r){r=l(r);var s=/[\\"']/g;r=r.replace(s,function(t){return"\\"+t});r=r.replace(/%/g,"\\x25");r=r.replace(/\n/g,"\\n");r=r.replace(/\r/g,"\\r");r=r.replace(/\x01/g,"\\x01");return r},escapeQueryString:function(r){r=l(r);return escape(r).replace(/\+/g,"%2B")},escapeHrefScript:function(r){r=q.escapeScript(r);r=r.replace(/%/g,"%25");r=q.escapeElementAttribute(r);return r},escapeRegExp:function(r){r=l(r);var s=/[\\\^\$\*\+\?\{\}\.\(\)\[\]]/g;return r.replace(s,function(u,t){return"\\"+u})}})})(n,n.String);(function(q){var p=f.prototype.slice;q.prototype={constructor:q,value:"",init:function(r){this.value=l(r)},toString:function(){return this.value},valueOf:function(){return this.value},format:function(t,r){var s=p.call(arguments,0);s=[this.value].concat(s);this.value=q.format.apply(null,s);return this},replaceAll:function(t,s){var r=p.call(arguments,0);r=[this.value].concat(r);this.value=q.replaceAll.apply(null,r);return this},replaceBetween:function(u,t,s){var r=p.call(arguments,0);r=[this.value].concat(r);this.value=q.replaceBetween.apply(null,r);return this},removeAll:function(r){this.value=q.replaceAll(this.value,r,"");return this},random:function(r){this.value=q.random(r);return this},trim:function(){this.value=q.trim(this.value);return this},trimStart:function(){this.value=q.trimStart(this.value);return this},trimEnd:function(){this.value=q.trimEnd(this.value);return this},split:function(r){return q.split(this.value,r)},startsWith:function(s,r){return q.startsWith(this.value,s,r)},endsWith:function(s,r){return q.endsWith(this.value,s,r)},contains:function(s,r){return q.contains(this.value,s,r)},padLeft:function(r,s){this.value=q.padLeft(this.value,r,s);return this},padRight:function(r,s){this.value=q.padRight(this.value,r,s);return this},toCamelCase:function(){this.value=q.toCamelCase(this.value);return this},toHyphenate:function(){this.value=q.toHyphenate(this.value);return this},between:function(s,r){this.value=q.between(this.value,s,r);return this},toUtf8:function(){this.value=q.toUtf8(this.value);return this},toValue:function(r){return q.toValue(this.value)},slide:function(s,r){return q.slide(this.value,s,r)},segment:function(r){return q.segment(this.value,r,r)}};q.prototype.init.prototype=q.prototype})(n.String);n.Boolean=function(p){return new n.Boolean.prototype.init(p)};(function(p,q){p.extend(q,{parse:function(r){if(!r){return false}if(typeof r=="string"||r instanceof l){var s=/^(false|null|undefined|0|NaN)$/g;return !s.test(r)}return true},toInt:function(r){return q.parse(r)?1:0},reverse:function(r){return !q.parse(r)},random:function(){return !!b.floor(b.random()*2)}})})(n,n.Boolean);(function(p){p.prototype={constructor:p,value:false,init:function(q){this.value=p.parse(q)},valueOf:function(){return this.value},toString:function(){return this.value.toString()},toInt:function(){return this.value?1:0},reverse:function(){this.value=!this.value;return this},random:function(){this.value=p.random();return}};p.prototype.init.prototype=p.prototype})(n.Boolean);n.Date=function(p){return new n.Date.prototype.init(p)};(function(p,q){p.extend(q,{now:function(){return new k()},parse:function(x){if(x instanceof k){if(isNaN(x.getTime())){return null}return x}if(typeof x!="string"){return null}var u=new k(x);if(!isNaN(u.getTime())){return u}function z(B){var t=new k();var C=B.indexOf(".")>0?".":B.indexOf("-")>0?"-":B.indexOf("/")>0?"/":B.indexOf("_")>0?"_":null;if(!C){return null}var D=B.split(C);return{yyyy:D[0],MM:D[1]||0,dd:D[2]||1}}function y(t){var B=t.indexOf(":")>0?":":null;if(!B){return null}var C=t.split(B);return{HH:C[0]||0,mm:C[1]||0,ss:C[2]||0}}var v=x.split(" ");if(!v[0]){return null}var u=v[0].indexOf(":")>0?null:v[0];var s=v[0].indexOf(":")>0?v[0]:(v[1]||null);if(u||s){if(u&&s){var w=z(u);var A=y(s);return new k(w.yyyy,w.MM-1,w.dd,A.HH,A.mm,A.ss)}if(u){var w=z(u);return new k(w.yyyy,w.MM-1,w.dd)}if(s){var r=new k();var A=y(s);return new k(r.getFullYear(),r.getMonth(),r.getDate(),A.HH,A.mm,A.ss)}}return null},format:function(C,v){var F=C.getFullYear();var A=C.getMonth()+1;var t=C.getDate();var w=C.getHours();var u=C.getMinutes();var r=C.getSeconds();var x=function(I,s){return p.String.padLeft(I,s,"0")};var B=w<=12;var E=[["yyyy",x(F,4)],["yy",l(F).slice(2)],["MM",x(A,2)],["M",A],["dddd","星期"+("日一二三四五六".charAt(C.getDay()))],["dd",x(t,2)],["d",t],["HH",x(w,2)],["H",w],["hh",x(B?w:w-12,2)],["h",B?w:w-12],["mm",x(u,2)],["m",u],["ss",x(r,2)],["s",r],["tt",B?"AM":"PM"],["t",B?"A":"P"],["TT",B?"上午":"下午"],["T",B?"上":"下"]];var H=v;var D=p.String.replaceAll;for(var y=0,z=E.length;y<z;y++){var G=E[y];H=D(H,G[0],G[1])}return H},addYears:function(s,r){r=r*12;return q.addMonths(s,r)},addMonths:function(t,s){if(!(t instanceof k)){s=t;t=new k()}var r=new k(t);r.setMonth(t.getMonth()+s);return r},addWeeks:function(s,r){r=r*7;return q.addDays(s,r)},addDays:function(t,s){if(!(t instanceof k)){s=t;t=new k()}var r=new k(t);r.setDate(t.getDate()+s);return r},addHours:function(t,s){if(!(t instanceof k)){s=t;t=new k()}var r=new k(t);r.setHours(t.getHours()+s);return r},addMinutes:function(t,s){if(!(t instanceof k)){s=t;t=new k()}var r=new k(t);r.setMinutes(t.getMinutes()+s);return r},addSeconds:function(t,s){if(!(t instanceof k)){s=t;t=new k()}var r=new k(t);r.setSeconds(t.getSeconds()+s);return r},addMilliseconds:function(t,s){if(!(t instanceof k)){s=t;t=new k()}var r=new k(t);r.setMilliseconds(t.getMilliseconds()+s);return r}})})(n,n.Date);(function(p){p.prototype={constructor:p,value:new k(),init:function(q){this.value=q===d?new k():p.parse(q)},valueOf:function(){return this.value},toString:function(q){return p.format(this.value,q)},format:function(q){return p.format(this.value,q)},addYears:function(q){this.value=p.addYears(this.value,q);return this},addMonths:function(q){this.value=p.addMonths(this.value,q);return this},addDays:function(q){this.value=p.addDays(this.value,q);return this},addHours:function(q){this.value=p.addHours(this.value,q);return this},addMinutes:function(q){this.value=p.addMinutes(this.value,q);return this},addSeconds:function(q){this.value=p.addSeconds(this.value,q);return this},addMilliseconds:function(q){this.value=p.addMilliseconds(this.value,q);return this}};p.prototype.init.prototype=p.prototype})(n.Date);n.Math=(function(p,q){return p.extend(q,{randomInt:function(s,t){if(s===d&&t===d){return j(l(b.random()).replace(".","").replace(/^0*/g,""))}else{if(t===d){t=s;s=0}}var r=t-s+1;return b.floor(b.random()*r+s)},slide:function(r,s,t){t=t||1;r+=t;if(r>=0){return r%s}return(s-(b.abs(r)%s))%s},next:function(r,s){return q.slide(r,s,1)},previous:function(r,s,t){return q.slide(r,s,-1)},parseInt:function(r){return parseInt(r,10)},parsePercent:function(r){if(typeof r=="string"&&p.String(r).trim().endsWith("%")){return parseInt(r)/100}return r}})})(n,{});n.Url=(function(p,q){return p.extend(q,{getQueryString:function(u,v,s){var w=u.indexOf("?");if(w<0){return}var x=u.indexOf("#");if(x<0){x=u.length}var r=u.substring(w+1,x);if(v===""){return r}var y=p.Object.parseQueryString(r);if(v===d){return y}if(!s||v in y){return y[v]}for(var t in y){if(t.toLowerCase()==v.toString().toLowerCase()){return y[t]}}},setQueryString:function(u,w,x){var y=q.getQueryString(u)||{};if(p.Object.isPlain(w)){p.Object.extendDeeply(y,w)}else{y[w]=x}var r=p.Object.toQueryString(y);var v=u.indexOf("?")>-1;var t=u.indexOf("#")>-1;var s;if(v&&t){s=u.split(/\?|#/g);return s[0]+"?"+r+"#"+s[2]}if(v){s=u.split("?");return s[0]+"?"+r}if(t){s=u.split("#");return s[0]+"?"+r+"#"+s[1]}return u+"?"+r},hasQueryString:function(t,u,r){var v=q.getQueryString(t);if(!v){return false}if(!u){return !p.Object.isEmpty(v)}if(u in v){return true}if(r){for(var s in v){if(s.toLowerCase()==u.toString().toLowerCase()){return true}}}return false}})})(n,{});n.Guid=(function(p,t){var s="__anonymousName_"+p.String.random();var r={};var q={};return p.extend(t,{next:function(v){if(arguments.length==0){v=s}var u=r[v]||0;u=u+1;r[v]=u;return u},reset:function(u){if(arguments.length==0){u=s}r[u]=0},get:function(z,x){x=x||"{0}";var w=/\{\d+\}/g;var u=x.match(w);var v=p.Array.map(u,function(B,A){return t.next(z)});var y=p.String.format(x,v);t.add(y);return y},add:function(u){q[u]=true},remove:function(u){delete q[u]},exist:function(u){return !!q[u]}})})(n,{});n.Mapper=(function(s){var q="__guid__"+s.String.random();var r={};function t(v,w){var u=s.String.random();this[q]=u;r[u]={guid:{},"false":{},string:{},number:{},"boolean":{},object:{},"function":{},"undefined":{}};if(arguments.length>0){this.set(v,w)}}function p(v){if(typeof v=="function"){var u=[];if("name" in v){u.push(v.name)}if("length" in v){u.push(v.length)}if(u.length>0){return u.join("#")}}return s.Object.getType(v)}s.extend(t,{getGuidKey:function(){return q}});s.extend(t.prototype,{set:function(B,z){var x=r[this[q]];if(!B){x["false"][l(B)]=z;return z}var w=typeof B;if(w=="object"&&q in B){var u=B[q];x.guid[u]=z;return}switch(w){case"string":case"number":case"boolean":x[w][l(B)]=z;break;case"object":case"function":var v=p(B);var y=x[w][v];if(y){var A=s.Array.findItem(y,function(D,C){return D[0]===B});if(A){A[1]=z}else{y.push([B,z])}}else{y=[[B,z]]}x[w][v]=y}return z},setBatch:function(v){var u=this;s.Array.each(v,function(x,w){u.set(x[0],x[1])})},get:function(A){var x=r[this[q]];if(!A){return x["false"][l(A)]}var w=typeof A;if(w=="object"&&q in A){var u=A[q];return x.guid[u]}switch(w){case"string":case"number":case"boolean":return x[w][l(A)];case"object":case"function":var v=p(A);var y=x[w][v];if(y){var z=s.Array.findItem(y,function(C,B){return C[0]===A});if(z){return z[1]}}}return d},remove:function(z){var x=r[this[q]];if(!z){delete x["false"][l(z)];return}var w=typeof z;if(w=="object"&&q in z){var u=z[q];delete x.guid[u];return}switch(w){case"string":case"number":case"boolean":delete x[w][l(z)];break;case"object":case"function":var v=p(z);var y=x[w][v];if(y){x[w][v]=s.Array.grep(y,function(B,A){return B[0]!==z})}}},dispose:function(){r[this[q]]=null;delete this[q]}});return t})(n);n.Event=function m(p){return new n.Event.prototype.init(p)};(function(p,t,q){var s=new q();var r=f.prototype.slice;p.extend(t,{bind:function(z,u,w,x){var v=s.get(z);if(!v){v={};s.set(z,v)}switch(typeof u){case"string":y(u,w);break;case"object":if(!p.Object.isPlain(u)){throw new h("当别参数 eventName 为 object 类型时，必须指定为纯对象 {}")}x=w;p.Object.each(u,function(A,B){y(A,B)});break;default:throw new h("无法识别参数 eventName 的类型");break}x=!!x;function y(A,B){if(typeof B!="function"){throw new h("参数 fn 必须为一个 function")}var C=v[A]||[];C.push({fn:B,isOnce:x});v[A]=C}},once:function(x,u,w){var v=r.call(arguments,0).concat([true]);t.bind.apply(null,v)},unbind:function(y,u,w){var v=s.get(y);if(!v){return}if(u===d){s.remove(y);return}if(typeof u!="string"){throw new h("如果指定了参数 eventName，则其类型必须为 string")}var x=v[u];if(!x){return}if(!w){v[u]=[];return}v[u]=p.Array.grep(x,function(A,z){return A.fn!==w})},trigger:function(z,u,v){var y=[];var w=s.get(z);if(!w){return y}var x=w[u];if(!x){return y}v=v||[];w[u]=p.Array.grep(x,function(B,A){var C=B.fn.apply(z,v);y.push(C);return !B.isOnce});return y},triggerStop:function(w,x,A,u){var C=[];var E=s.get(w);if(!E){return C}var z=E[x];if(!z){return C}A=A||[];if(arguments.length==3){u=false}var B=[];for(var v=0,y=z.length;v<y;v++){var F=z[v];var D=F.fn.apply(w,A);if(!F.isOnce){B.push(F)}C.push(D);if(D===u){break}}z=z.slice(v+1);E[x]=B.concat(z);return C},has:function(z,u,x){var w=s.get(z);if(!w){return false}if(u===d){if(p.Object.isEmpty(w)){return false}var v=false;p.Object.each(w,function(A,B){if(B&&B.length>0){v=true;return false}});return v}if(typeof u!="string"){throw new h("如果指定了参数 eventName，则其类型必须为 string")}var y=w[u];if(!y||y.length==0){return false}if(x===d){return true}return p.Array.find(y,function(B,A){return B.fn===x})},toggle:function(x,u,v,w){if(t.has(x,u,v)){t.unbind(x,u,v)}else{t.bind(x,u,v,w)}},unique:function(x,u,v,w){if(t.has(x,u,v)){return}t.bind(x,u,v,w)}})})(n,n.Event,n.Mapper);(function(q){var p=f.prototype.slice;q.prototype={constructor:q,value:{},init:function(r){this.value=r},valueOf:function(){return this.value},on:function(r,t,u){var s=[this.value].concat(p.call(arguments,0));q.bind.apply(null,s);return this},off:function(r,t){var s=[this.value].concat(p.call(arguments,0));q.unbind.apply(null,s);return this},bind:function(r,t,u){var s=[this.value].concat(p.call(arguments,0));q.bind.apply(null,s);return this},unbind:function(r,t){var s=[this.value].concat(p.call(arguments,0));q.unbind.apply(null,s);return this},once:function(r,t){var s=[this.value].concat(p.call(arguments,0));q.once.apply(null,s);return this},trigger:function(r,s){var s=[this.value].concat(p.call(arguments,0));return q.trigger.apply(null,s)},triggerStop:function(r,s,t){var s=[this.value].concat(p.call(arguments,0));return q.triggerStop.apply(null,s)},fire:function(r,s){var s=[this.value].concat(p.call(arguments,0));return q.trigger.apply(null,s)},fireStop:function(r,s,t){var s=[this.value].concat(p.call(arguments,0));return q.triggerStop.apply(null,s)},has:function(r,t){var s=[this.value].concat(p.call(arguments,0));return q.has.apply(null,s)},toggle:function(r,t,u){var s=[this.value].concat(p.call(arguments,0));q.toggle.apply(null,s);return this},unique:function(r,t,u){var s=[this.value].concat(p.call(arguments,0));return q.unique.apply(null,s)},};q.prototype.init.prototype=q.prototype})(n.Event);n.Callbacks=(function(s,t){var p=t.getGuidKey();var q="__callback__"+s.String.random();var u=f.prototype.slice;function r(){this[p]=s.String.random()}s.extend(r.prototype,{add:function(w,x){var v=[this,q].concat(u.call(arguments,0));s.Event.bind.apply(null,v)},once:function(w){var v=[this,q].concat(u.call(arguments,0));s.Event.once.apply(null,v)},remove:function(w){var v=[this,q].concat(u.call(arguments,0));s.Event.unbind.apply(null,v)},fire:function(){var v=u.call(arguments,0);return s.Event.trigger(this,q,v)},fireWith:function(y){var z=p in y;var v=y[p];y[p]=this[p];var x=u.call(arguments,1);var w=s.Event.trigger(y,q,x);if(z){y[p]=v}else{delete y[p]}return w},fireStop:function(w){var v=u.call(arguments,1);return s.Event.triggerStop(this,q,v,w)},has:function(w){var v=[this,q].concat(u.call(arguments,0));return s.Event.has.apply(null,v)},toggle:function(w,x){var v=[this,q].concat(u.call(arguments,0));s.Event.toggle.apply(null,v)},unique:function(w,x){var v=[this,q].concat(u.call(arguments,0));s.Event.unique.apply(null,v)}});return r})(n,n.Mapper);n.States=(function(s,t){var q=t.getGuidKey();var v=new t();function p(z,y){this[q]=s.String.random();var x={};var A={};v.set(this,{states:x,paths:A,histories:[z]});var w=this;var B=s.Event.bind;y=r(y);s.Array.each(y,function(E,C){var G=E.from;var F=E.to;var D=E.fn;if(G&&F){B(w,G+"->"+F,D);A[G+"->"+F]=true;x[G]=true;x[F]=true}else{if(G){B(w,G+"->",D);x[G]=true}else{if(F){B(w,"->"+F,D);x[F]=true}else{B(w,"->",D)}}}})}function r(w){var x=[];if(s.Object.isPlain(w)){s.Object.each(w,function(z,A){var B=z.split("->");var D=B[0];var C=B[1];if(D.indexOf("|")>0||C.indexOf("|")>0){D=D.split("|");C=C.split("|");var y=u(D,C,A);x=x.concat(y)}else{x.push({from:D,to:C,fn:A})}})}else{if(s.Object.isArray(w)){s.Array.each(w,function(C,A){var F=C.from;var E=C.to;var B=C.fn;var y=F instanceof f;var D=E instanceof f;if(y||D){if(!y){F=[F]}else{if(!D){E=[E]}}var z=u(F,E,B);x=x.concat(z)}else{x.push(C)}})}}return x}function u(x,z,y){var w=s.Array.descartes(x,z);return s.Array.map(w,function(B,A){return{from:B[0],to:B[1],fn:y}})}s.extend(p.prototype,{to:function(x,w){var y=this.current();if(!this.has(y,x)){throw new h(s.String.format("不存在从状态 {0} 到状态 {1} 的路径",y,x))}v.get(this).histories.push(x);s.Event.trigger(this,y+"->",w);s.Event.trigger(this,y+"->"+x,w);s.Event.trigger(this,"->"+x,w);s.Event.trigger(this,"->",w)},backward:function(y){var w=v.get(this).histories;var x=w.length-2;if(x>=0){this.to(w[x],y)}},current:function(){var w=v.get(this).histories;return w[w.length-1]},has:function(z,y){var w=v.get(this).states;if(y===d){return !!w[z]}var x=v.get(this).paths;return !!x[z+"->"+y]},states:function(){var w=v.get(this).states;return s.Object.getKeys(w)},paths:function(){var w=v.get(this).paths;return s.Object.getKeys(w)},histories:function(){var w=v.get(this).histories;return w.slice(0)},length:function(){return this.states().length}});return p})(n,n.Mapper);(function(q,s,r){var t=new r();var p="__hashchange__"+q.String.random();return q.extend(s,{hashchange:function(w,v){q.Event.bind(w,p,v);var u=w.document.location;var x=u.hash;if(x){v.call(w,x.slice(1),null)}if(t.get(w)){return}if("onhashchange" in w){w.onhashchange=function(){var y=x;x=u.hash;q.Event.trigger(w,p,[x.slice(1),y.slice(1)])}}else{setInterval(function(){var y=x;x=u.hash;if(x!=y){q.Event.trigger(w,p,[x.slice(1),y.slice(1)])}},500)}t.set(w,true)},route:function(v,u){if(!q.Object.isPlain(u)){u=q.Object.make(u,arguments[2])}s.hashchange(v,function(x,y){var w=u[x];if(w){w.call(v,x,y)}})}})})(n,n.Url,n.Mapper);n.Cookie=(function(r,s){var q={"true":{},"false":{}};var p=(function(){var u=/^\d+([y|M|w|d|h|m|s]|ms)$/;var t={y:"Year",M:"Month",w:"Week",d:"Day",h:"Hour",m:"Minute",s:"Second",ms:"Millisecond"};return function(w){var v=new k();if(typeof w=="number"){return r.Date.addMilliseconds(v,w)}if(u.test(w)){var y=parseInt(w);var x=w.replace(/^\d+/g,"");return r.Date["add"+t[x]+"s"](v,y)}return r.Date.parse(w)}})();return r.extend(s,{toObject:function(u,t){if(typeof u!="string"){t=u;u=document.cookie}if(!u){return{}}t=!!t;var v=q[t][u];if(v){return v}v={};var w=r.Object.parseQueryString;r.Array.each(u.split("; "),function(A,z){var C=A.indexOf("=");var y=A.slice(0,C);y=decodeURIComponent(y);var B=A.slice(C+1);if(t&&B.indexOf("=")>-1){B=w(B)}else{B=decodeURIComponent(B)}if(y in v){var x=v[y];if(x instanceof f){x.push(B)}else{v[y]=[x,B]}}else{v[y]=B}});q[t][u]=v;return v},get:function(u,v){if(u===d){return s.toObject()}if(u===true){return s.toObject(true)}if(v===d){var x=s.toObject();return x[u]}var x=s.toObject(true);var w=x[u];if(v===true){return w}if(w instanceof f){var t=r.Array.grep(w,function(z,y){return z&&typeof z=="object"&&v in z});if(t.length==0){return}if(t.length==1){return t[0][v]}return r.Array.keep(t,function(z,y){return z[v]})}if(w&&typeof w=="object"){return w[v]}},set:function(v,y,t,A,x,z){if(r.Object.isPlain(v)){var u=v;v=u.name;y=u.value;t=u.expires;A=u.path;x=u.domain;z=u.secure}v=encodeURIComponent(v);if(!v){throw new h("参数 name 不能为空字符串")}if(r.Object.isPlain(y)){y=r.Object.toQueryString(y)}else{y=encodeURIComponent(y)}var w=v+"="+y+"; ";if(t){t=p(t);w+="expires="+t.toGMTString()+"; "}if(A){w+="path="+A+"; "}if(x){w+="domain="+x+"; "}if(z){w+="secure"}document.cookie=w},remove:function(u,y,v,x){var t=r.Object.isPlain(u)?u:{name:u,path:y,domain:v,secure:x};t.expires=new k(0);u=t.name;if(u===d){var w=s.toObject();r.Object.each(w,function(z,A){t.name=z;s.set(t)});return}s.set(t)}})})(n,{});n.Script=(function(r,t){function p(w,z,u,y){var v=u.createElement("script");v.type="text/javascript";if(z){v.charset=z}var x=u.getElementsByTagName("head")[0];if(v.readyState){v.onreadystatechange=function(){var A=v.readyState;if(A=="loaded"||A=="complete"){v.onreadystatechange=null;y&&y()}}}else{v.onload=function(){y&&y()}}v.src=w;x.appendChild(v)}function q(x,y,u,w){var v=0;(function(){var A=arguments.callee;var z=x[v];p(z,y,u,function(){v++;if(v<x.length){A()}else{w&&w()}})})();return}function s(v,x,u){var w=r.String.format('<script type="text/javascript" src="{src}" {charset} ><\/script>',{src:v,charset:x?r.String.format('charset="{0}"',x):""});u.write(w)}return r.extend(t,{load:function(v){var u={url:"",charset:"utf-8",document:window.document,onload:function(){}};if(r.Object.isPlain(v)){r.Object.extend(u,v)}else{u.url=v;switch(typeof arguments[1]){case"string":u.charset=arguments[1];break;case"object":u.document=arguments[1];break;case"function":u.onload=arguments[1];break}switch(typeof arguments[2]){case"object":u.document=arguments[2];break;case"function":u.onload=arguments[2];break}if(arguments[3]){u.onload=arguments[3]}}if(r.Object.isArray(u.url)){q(u.url,u.charset,u.document,u.onload)}else{if(typeof u.url=="string"){p(u.url,u.charset,u.document,u.onload)}else{throw new h("参数 params.url 必须为 string 或 string 的数组")}}},insert:function(x){var w={code:"",id:"",document:window.document};if(r.Object.isPlain(x)){r.Object.extend(w,x)}else{w.code=x;switch(typeof arguments[1]){case"string":w.id=arguments[1];break;case"object":w.document=arguments[1];break}if(arguments[2]){w.document=arguments[2]}}var u=w.document.createElement("script");u.type="text/javascript";if(w.id){u.id=w.id}try{u.appendChild(w.document.createTextNode(w.code))}catch(v){u.text=w.code}w.document.getElementsByTagName("head")[0].appendChild(u)},write:function(y){var x={url:"",charset:"",document:window.document};if(r.Object.isPlain(y)){r.Object.extend(x,y)}else{x.url=y;switch(typeof arguments[1]){case"string":x.charset=arguments[1];break;case"object":x.document=arguments[1];break}if(arguments[2]){x.document=arguments[2]}}if(r.Object.isArray(x.url)){var w=x.url;for(var v=0,u=w.length;v<u;v++){s(w[v],x.charset,x.document)}}else{s(x.url,x.charset,x.document)}}})})(n,{});n.Xhr=(function(p,q){return p.extend(q,{create:function(){var r=window.XMLHttpRequest?function(){return new XMLHttpRequest()}:window.ActiveXObject?function(){var u=arguments.callee;var x="version";if(!u[x]){var t=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"];for(var w=0,s=t.length;w<s;w++){try{var y=new ActiveXObject(t[w]);u[x]=t[w];return y}catch(v){}}}return new ActiveXObject(u[x])}:function(){throw new h("没有可用的 XHR 对象")};q.create=r;return r()}})})(n,{});n.Xml=(function(t,u){function p(){var y=arguments.callee;if(!y.version){var x=["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument"];for(var A=0,w=x.length;A<w;A++){try{var v=new ActiveXObject(x[A]);y.version=x[A];return v}catch(z){}}}return new ActiveXObject(y.version)}function r(w,v){var x={};var y=t.Object.parseQueryString;t.Array(w.attributes).each(function(A,z){if(A.specified){var B=A.value;if(v&&B.indexOf("=")>0){x[A.name]=y(B)}else{x[A.name]=B}}});return x}function q(y){var v=null;var x=document.implementation;if(window.DOMParser){v=(new DOMParser()).parseFromString(y,"text/xml");var A=v.getElementsByTagName("parsererror");if(A.length>0){throw new h("XML 解析错误: "+A[0].textContent)}}else{if(x.hasFeature("LS","3.0")){var z=x.createLSParser(x.MODE_SYNCHRONOUS,null);var w=x.createInput();w.stringData=y;v=z.parse(w)}else{v=p();v.loadXML(y);if(v.parseError.errorCode!=0){throw new h("XML 解析错误: "+v.parseError.reason)}}}if(!v){throw new h("没有可用的 XML 解析器")}return v}function s(C,w){var A=arguments.callee;if(!w){for(w in C){return A(C[w],w)}throw new h("参数 obj 中不包含任何成员")}var v=[];var y=[];for(var x in C){if(t.Object.isArray(C[x])){t.Array.each(C[x],function(E,D){y.push(A(E,x))});continue}var z=typeof C[x];if(z=="string"||z=="number"||z=="boolean"){var B=l(C[x]).replace(/"/g,'\\"');v.push(t.String.format('{0}="{1}"',x,B))}else{throw new h("非法数据类型的属性值: "+x)}}return t.String.format("<{name} {attributes}>{children}</{name}>",{name:w,attributes:v.join(" "),children:y.join(" \r\n")})}return t.extend(u,{parse:function(w){var v="";if(typeof w=="string"){v=w}else{if(typeof w=="object"&&w){v=s(w)}}if(!v){throw new h("非法的参数 data")}return q(v)},toString:function(w){if(!w||typeof w!="object"){return""}if(w.nodeName){var v=w;if(window.XMLSerializer){return(new XMLSerializer()).serializeToString(v)}if(document.implementation.hasFeature("LS","3.0")){return document.implementation.createLSSerializer().writeToString(v)}return v.xml}return s(w)},toObject:function(y,w){var x=arguments.callee;if(typeof y=="string"){var A=y;var z=q(A);return x(z,w)}if(y&&y.documentElement){var z=y;var B={};B[z.documentElement.nodeName]=x(z.documentElement,w);return B}if(!y||!y.nodeName){throw new h("参数 node 错误：非法的 XML 节点")}var B=r(y,w);var C=t.Array.parse(y.childNodes);if(C.length==1){var v=C[0];if(v.nodeType==3){B.value=v.nodeValue;return B}}t.Array(C).grep(function(E,D){return E.nodeType===1}).each(function(F,E){var D=F.nodeName;if(!B[D]){B[D]=[]}B[D].push(x(F))});return B}})})(n,{});n.Url.Current=(function(s,q,p){var r=f.prototype.slice;return{getQueryString:function(v,t){var u=r.call(arguments,0);u=[p.href].concat(u);return s.getQueryString.apply(null,u)},setQueryString:function(u,v){var t=r.call(arguments,0);t=[p.href].concat(t);return s.setQueryString.apply(null,t)},hasQueryString:function(v,t){var u=r.call(arguments,0);u=[p.href].concat(u);return s.hasQueryString.apply(null,u)},hashchange:function(u){var t=r.call(arguments,0);t=[q].concat(t);s.hashchange.apply(null,t)},route:function(t){var u=r.call(arguments,0);u=[q].concat(u);s.route.apply(null,u)}}})(n.Url,window,document.location);n.use=function(p,q){if(!a[p]||q){a[p]=n;return}var s=a[p];for(var r in n){if(!(r in s)){s[r]=n[r]}}};if(typeof exports!="undefined"){if(typeof module!="undefined"&&module.exports){exports=module.exports=n}exports.MiniQuery=n}else{if(typeof define=="function"&&define.amd){define(function(p){return n})}else{a.MiniQuery=n}}})(typeof global=="object"?global:this,Array,Boolean,Date,Error,Function,Math,Number,Object,RegExp,String);